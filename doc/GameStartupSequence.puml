@startuml GameStartupSequence
!theme plain

participant "main()" as MAIN
participant "Game" as G
participant "World" as W
participant "Systems" as S
participant "Config Loader" as CL
participant "SDL3" as SDL
participant "Assets" as ASSETS

== INITIALIZATION ==

MAIN -> G: game.Init()
note right of G
    Iniciar sistema de juego
end note

G -> SDL: InitializeSDL()
note right of SDL
    SDL_Init(SDL_INIT_VIDEO)
    SDL_Init(SDL_INIT_AUDIO)
end note

G -> SDL: CreateWindow("Mega Man ECS", 1920, 1080)
SDL --> G: window*

G -> SDL: CreateRenderer(window, SDL3_TEXTUREFORMAT_XRGB8888)
SDL --> G: renderer*

G -> G: m_World = new World()
note right of G
    Crear instancia World
end note

== LOAD CONFIGURATION ==

G -> CL: LoadConfig("assets/config/settings.json")
note right of CL
    Parsear JSON
    resolution: [1920, 1080]
    framerate: 60
    vsync: true
end note

CL -> CL: LoadEnemyConfig("assets/config/Enemy_entities.json")
CL -> CL: LoadWavesConfig("assets/config/Waves.json")
CL -> CL: LoadPlayerConfig("assets/config/Player_entity.json")

CL --> G: configData

== LOAD ASSETS ==

G -> ASSETS: LoadTextures()
note right of ASSETS
    megaman.png
    Enemy1.png
    Enemigo2.png
    obstaculo.png
    backgrounds/BG-*.png
end note

G -> ASSETS: LoadAudio()
note right of ASSETS
    Chipzel - Courtesy.flac
end note

ASSETS --> G: assetsLoaded

== CREATE SYSTEMS ==

G -> S: CreateSystems()
note right of S
    Crear e inicializar:
    - PlayerInputSystem
    - MovementSystem
    - CollisionSystem
    - CollisionResponseSystem
    - EnemyAISystem
    - DamageSystem
    - SpawnSystem
    - WaveManagerSystem
    - RenderSystem
    - HUDSystem
    - LifetimeSystem
    - BackgroundSystem
end note

S -> S: system->Init()
note right of S
    Cada sistema:
    - Registra en World
    - Inicializa cache
    - Se suscribe a eventos
end note

== CREATE PLAYER ==

G -> W: player = CreateEntity()
note right of W
    Nuevo ID = 0
end note

G -> W: player->AttachComponent<Transform>(1920/2, 1080-100)
G -> W: player->AttachComponent<Health>(100)
G -> W: player->AttachComponent<Collider>()
G -> W: player->AttachComponent<Sprite>(megaman.png)
G -> W: player->AttachComponent<Player>()

== READY ==

note over MAIN, ASSETS
    ✓ Inicialización completa
    ✓ Juego listo
    ✓ Todos sistemas activos
    ✓ Primer frame puede procesar
end note

@enduml
