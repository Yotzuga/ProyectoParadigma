@startuml GameStartup
title Secuencia: Inicio del Juego

participant "main()" as MAIN
participant "Game" as G
participant "World" as W
participant "ConfigLoader" as CL
participant "EntityFactory" as EF
participant "Systems" as S

MAIN -> G: Game()
MAIN -> G: Initialize()
activate G
  G -> G: SDL_Init()
  G -> G: CreateWindow()
  G -> G: CreateRenderer()
deactivate G

MAIN -> G: Start()
activate G
  G -> CL: LoadConfiguration()
  activate CL
    CL -> CL: Cargar settings.json
    CL -> CL: Cargar Waves.json
    CL -> CL: Cargar Enemy_entities.json
    CL -> CL: Cargar ObstaclesByFase.json
  deactivate CL
  
  G -> EF: CreatePlayer()
  activate EF
    EF -> W: createEntity()
    activate W
      W -> W: Generar ID Ãºnico
      W -> W: m_EntityMap[id] = entity
      W -> W: m_PlayerEntity = entity
    deactivate W
    EF -> EF: AddComponent<Transform>()
    EF -> EF: AddComponent<Sprite>()
    EF -> EF: AddComponent<Collider>()
    EF -> EF: AddComponent<Health>()
    EF -> EF: AddComponent<Player>()
  deactivate EF
  
  G -> S: WaveManagerSystem.LoadConfig()
  activate S
    S -> S: WaveSystem.LoadWaves()
    S -> S: SpawnSystem.SetObstacles()
  deactivate S
deactivate G

MAIN -> G: Run()
note over MAIN, S
  Inicia game loop principal
end note

@enduml
